Here’s your **full updated grocery list app** code with:

* Free-typed categories (stored in Google Sheets column **E**).
* Auto-generated category filter tabs.
* A live **search box** above the filters.

---

# **Google Sheet Setup**

Create a sheet called **GroceryList** with the following headers in row 1:

```
A: id        | B: name  | C: amount | D: crossed | E: category | F: createdAt | G: updatedAt
```

* Column **E (category)** is where all categories are stored.
* Each new item will automatically get its category written there.
* If left blank, it defaults to **Uncategorized**.

---

# **Frontend HTML (index.html)**

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grocery List</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    .card { background: white; padding: 16px; margin-bottom: 20px; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .row { display: flex; gap: 10px; margin-bottom: 10px; }
    input { flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 8px; }
    button { padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; background: #1976d2; color: white; }
    button.secondary { background: #555; }
    button.danger { background: #d32f2f; }
    button.filter { background: #eee; color: #333; }
    button.filter.active { background: #1976d2; color: white; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
    .crossed { text-decoration: line-through; color: gray; }
    .clickable { cursor: pointer; }
    #filters { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 10px; }
  </style>
</head>
<body>
  <h1>Grocery List</h1>

  <!-- Add Item Section -->
  <section class="card" aria-label="Add item">
    <div class="row">
      <input id="itemInput" type="text" placeholder="Add an item (e.g., bananas)" />
      <input id="categoryInput" type="text" placeholder="Category (e.g., Produce)" />
      <button id="addBtn">Add Item</button>
    </div>
    <div id="status" aria-live="polite"></div>
  </section>

  <!-- Search Box -->
  <section class="card" aria-label="Search items">
    <input id="searchInput" type="text" placeholder="Search items..." />
  </section>

  <!-- Filter Tabs -->
  <section class="card" aria-label="Category filters">
    <div id="filters"></div>
  </section>

  <!-- List Display Section -->
  <section class="card" aria-label="Grocery list">
    <table id="listTable">
      <thead>
        <tr>
          <th style="width:30%">Item</th>
          <th style="width:15%">Amount</th>
          <th style="width:20%">Category</th>
          <th style="width:35%">Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbw-opuhHpnlWM-lGGqLR1AH6yBYcBfKLuvnbv5hNXS6s1eokBtqKVHGEY2CKR_X1cX2/exec"; // replace with your Apps Script Web App URL
    let currentFilter = 'All';
    let allItems = [];
    let searchQuery = '';

    document.getElementById('addBtn').addEventListener('click', ()=>{
      const name = document.getElementById('itemInput').value.trim();
      addItem(name);
    });

    document.getElementById('searchInput').addEventListener('input', e => {
      searchQuery = e.target.value.toLowerCase();
      renderList();
    });

    function setStatus(msg, ok){
      const el = document.getElementById('status');
      el.textContent = msg;
      el.style.color = ok === 'ok' ? 'green' : (ok === 'err' ? 'red' : 'black');
    }

    async function addItem(name){
      name = name.trim();
      const category = document.getElementById('categoryInput').value.trim() || "Uncategorized";
      if(!name){ setStatus('Please enter an item name.', 'err'); return; }
      try{
        const body = new URLSearchParams({ action: 'add', name, category });
        const res = await fetch(API_URL, { method: 'POST', headers:{'Content-Type':'application/x-www-form-urlencoded;charset=UTF-8'}, body });
        const json = await res.json();
        if(json.status !== 'success') throw new Error(json.message || 'Unknown error');
        setStatus('Item added.', 'ok');
        document.getElementById('itemInput').value = '';
        document.getElementById('categoryInput').value = '';
        await loadList();
      }catch(err){
        console.error(err);
        setStatus('Failed to add: ' + err.message, 'err');
      }
    }

    async function loadList(){
      try{
        const res = await fetch(API_URL + '?action=list');
        const json = await res.json();
        if(json.status !== 'success') throw new Error(json.message || 'Unknown error');
        allItems = json.items;
        buildFilters();
        renderList();
      }catch(err){
        console.error(err);
        setStatus('Failed to load list: ' + err.message, 'err');
      }
    }

    function buildFilters(){
      const filtersDiv = document.getElementById('filters');
      filtersDiv.innerHTML = '';
      const categories = [...new Set(allItems.map(i => i.category || 'Uncategorized'))];
      categories.sort();
      categories.unshift('All');
      categories.forEach(cat => {
        const btn = document.createElement('button');
        btn.textContent = cat;
        btn.className = 'filter' + (cat === currentFilter ? ' active' : '');
        btn.addEventListener('click', ()=>{
          currentFilter = cat;
          buildFilters();
          renderList();
        });
        filtersDiv.appendChild(btn);
      });
    }

    function renderList(){
      const tbody = document.querySelector('#listTable tbody');
      tbody.innerHTML = '';
      allItems
        .filter(item => currentFilter === 'All' || item.category === currentFilter)
        .filter(item => !searchQuery || item.name.toLowerCase().includes(searchQuery))
        .forEach(item => tbody.insertAdjacentHTML('beforeend', rowHtml(item)));
    }

    function rowHtml(item){
      const crossedCls = item.crossed ? 'crossed' : '';
      const amountCls = 'clickable';
      return `<tr data-id="${item.id}">
        <td><span class="item-name ${crossedCls}">${escapeHtml(item.name)}</span></td>
        <td><span class="${amountCls}">${escapeHtml(item.amount || '')}</span></td>
        <td>${escapeHtml(item.category || '—')}</td>
        <td class="actions">
          <button class="secondary" data-action="toggle">${item.crossed ? 'Uncross' : 'Cross off'}</button>
          <button class="danger" data-action="delete">Delete</button>
        </td>
      </tr>`;
    }

    document.querySelector('#listTable tbody').addEventListener('click', async e =>{
      const tr = e.target.closest('tr');
      if(!tr) return;
      const id = tr.dataset.id;
      const action = e.target.dataset.action;

      if(action === 'toggle'){
        await updateItem(id, 'toggle');
      }
      if(action === 'delete'){
        await updateItem(id, 'delete');
      }
    });

    document.querySelector('#listTable tbody').addEventListener('dblclick', async e =>{
      if(e.target.classList.contains('clickable')){
        const tr = e.target.closest('tr');
        const id = tr.dataset.id;
        const current = e.target.textContent;
        const newVal = prompt('Enter new amount:', current);
        if(newVal !== null){
          await updateItem(id, 'editAmount', newVal);
        }
      }
    });

    async function updateItem(id, action, value){
      try{
        const body = new URLSearchParams({ action, id });
        if(action === 'editAmount') body.append('amount', value);
        const res = await fetch(API_URL, { method: 'POST', headers:{'Content-Type':'application/x-www-form-urlencoded;charset=UTF-8'}, body });
        const json = await res.json();
        if(json.status !== 'success') throw new Error(json.message || 'Unknown error');
        await loadList();
      }catch(err){
        console.error(err);
        setStatus('Update failed: ' + err.message, 'err');
      }
    }

    function escapeHtml(str){
      return str.replace(/[&<>'"]/g, tag => ({'&':'&amp;','<':'&lt;','>':'&gt;','\'':'&#39;','\"':'&quot;'}[tag]));
    }

    loadList();
  </script>
</body>
</html>
```

---

# **Google Apps Script (Code.gs)**

No changes needed — it already saves categories in column **E** and returns them to the frontend.

---

✅ With this setup:

* Categories live in **column E** of your Google Sheet.
* The frontend builds filters + search dynamically from your data.
* Search works alongside category filters.

Do you also want the app to **remember the last selected filter/search** (so if you refresh, it stays on the same category/search)?
